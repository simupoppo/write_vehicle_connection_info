<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>simutrans 連結用dat自動記述アプリ</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.27.2/full/pyodide.js"></script>
</head>
<body>

  <h2>文字入力フォーム</h2>

  <form id="textForm">
    <input type="text" id="textInput" placeholder="ここに文字を入力" required>
    <button type="submit">追加</button>
  </form>

  <div id="output">
    <strong>表示欄:</strong>
    <div id="textList"></div>
  </div>
  <button id="selectButton">選択</button>

  <div id="relatedList">
    <strong>関連付けされた項目:</strong>
    <ul id="relationResults"></ul>
  </div>

  <script>
    const form = document.getElementById("textForm");
    const input = document.getElementById("textInput");
    const textList = document.getElementById("textList");
    const selectButton = document.getElementById("selectButton");
    const relationResults = document.getElementById("relationResults");

    form.addEventListener("submit", function(event) {
      event.preventDefault();

      const newText = input.value.trim();
      if (newText !== "") {
        const itemDiv = document.createElement("div");
        itemDiv.className = "item";

        // 左右のテキスト
        const textLeft = document.createElement("span");
        textLeft.textContent = newText;

        const textRight = document.createElement("span");
        textRight.textContent = newText;

        // チェックボックス2つ
        const checkbox1 = document.createElement("input");
        checkbox1.type = "checkbox";

        const checkbox2 = document.createElement("input");
        checkbox2.type = "checkbox";

        // 削除ボタン
        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "削除";
        deleteBtn.addEventListener("click", function () {
          textList.removeChild(itemDiv);
        });

        // データ属性で記録用に文字列を保持
        itemDiv.setAttribute("data-text", newText);

        // 要素構成
        itemDiv.appendChild(textLeft);
        itemDiv.appendChild(checkbox1);
        itemDiv.appendChild(checkbox2);
        itemDiv.appendChild(textRight);
        itemDiv.appendChild(deleteBtn);

        textList.appendChild(itemDiv);
        input.value = "";
      }
    });

    // 「選択」ボタンの動作
    selectButton.addEventListener("click", function () {
      const items = document.querySelectorAll(".item");
      relationResults.innerHTML = ""; // 前回の結果をクリア

      items.forEach(item => {
        const checkboxes = item.querySelectorAll("input[type='checkbox']");
        if (checkboxes.length === 2 && checkboxes[0].checked && checkboxes[1].checked) {
          const text = item.getAttribute("data-text");
          const li = document.createElement("li");
          li.textContent = `"${text}" が関連付けられました。`;
          relationResults.appendChild(li);
        }
      });
    });
  </script>



</body>
</html>
